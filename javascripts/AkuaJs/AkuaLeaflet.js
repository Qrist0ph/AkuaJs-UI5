define(["core/CoreBundle","leaflet"],function(){function c(b){Apple.call(this,b);this.axis0=b.axis0;this.height=b.height?b.height:400;this.InfoMessage=b.InfoMessage?b.InfoMessage:"Info:";this.Unit=b.Unit?b.Unit:"";this.MapCenter=b.MapCenter?b.MapCenter:[52.8,13];this.Zoom=b.Zoom?b.Zoom:8}c.prototype=new Apple;c.prototype.constructor=c;c.prototype.getView=function(){return this.view=$('<div id="'+this.divid+'" style="height:'+this.height+'px;"  > '+this.divid+"</div> ")};c.prototype.updateValues=function(b){var a=
this;a.map||(a.map=L.map(a.view[0]).setView(a.MapCenter,a.Zoom),(new L.TileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{minZoom:0,maxZoom:12,attribution:'Map data <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'})).addTo(a.map),a.info=L.control(),a.info.onAdd=function(a){this._div=L.DomUtil.create("div","info");this.update();return this._div},a.info.update=function(d){this._div.innerHTML="<h4>"+a.InfoMessage+"</h4>"+(d?"<b>"+d.Name+"</b><br />"+d.value.formatMoney(0,
",",".","")+" "+a.Unit:"")},a.info.addTo(this.map),b=L.control({position:"bottomright"}),b.onAdd=function(d){d=L.DomUtil.create("div","info legend");return a.legend=d},b.addTo(a.map));b={type:"FeatureCollection",features:[{type:"Feature",id:"AFG",properties:{name:"geoJsonStringnn"},geometry:{type:"Polygon",coordinates:[[[61.210817,35.650072],[62.230651,35.270664],[62.984662,35.404041],[63.193538,35.857166],[63.982896,36.007957],[64.546479,36.312073],[64.746105,37.111818],[65.588948,37.305217],[65.745631,
37.661164],[66.217385,37.39379],[66.518607,37.362784],[67.075782,37.356144],[67.83,37.144994],[68.135562,37.023115],[68.859446,37.344336],[69.196273,37.151144],[69.518785,37.608997],[70.116578,37.588223],[70.270574,37.735165],[70.376304,38.138396],[70.806821,38.486282],[71.348131,38.258905],[71.239404,37.953265],[71.541918,37.905774],[71.448693,37.065645],[71.844638,36.738171],[72.193041,36.948288],[72.63689,37.047558],[73.260056,37.495257],[73.948696,37.421566],[74.980002,37.41999],[75.158028,37.133031],
[74.575893,37.020841],[74.067552,36.836176],[72.920025,36.720007],[71.846292,36.509942],[71.262348,36.074388],[71.498768,35.650563],[71.613076,35.153203],[71.115019,34.733126],[71.156773,34.348911],[70.881803,33.988856],[69.930543,34.02012],[70.323594,33.358533],[69.687147,33.105499],[69.262522,32.501944],[69.317764,31.901412],[68.926677,31.620189],[68.556932,31.71331],[67.792689,31.58293],[67.683394,31.303154],[66.938891,31.304911],[66.381458,30.738899],[66.346473,29.887943],[65.046862,29.472181],
[64.350419,29.560031],[64.148002,29.340819],[63.550261,29.468331],[62.549857,29.318572],[60.874248,29.829239],[61.781222,30.73585],[61.699314,31.379506],[60.941945,31.548075],[60.863655,32.18292],[60.536078,32.981269],[60.9637,33.528832],[60.52843,33.676446],[60.803193,34.404102],[61.210817,35.650072]]]}}]};b=berlin;var c=this.calculateMinMax(),e=c.max,c=c.min,f=Math.abs(e)>Math.abs(c)?Math.abs(e):Math.abs(c),e=Enumerable.From(this.calculateBuckets(c,e)).Select(function(a){return'<i style="background:'+
a.color+'"></i> '+a.from.formatMoney(0,",",".","")+(a.to?"&ndash;"+a.to.formatMoney(0,",",".",""):"+")}).ToArray();a.legend.innerHTML=e.join("<br>");var g=function(b){b=b.target;b.setStyle({weight:2,color:"#666",dashArray:"",fillOpacity:.7});L.Browser.ie||L.Browser.opera||b.bringToFront();a.info.update(b.feature.properties)},h=function(b){a.geojson.resetStyle(b.target);a.info.update()};a.geojson&&a.map.removeLayer(a.geojson);a.geojson=L.geoJson(b,{style:function(b){var c=a.axis0.Tuples().FirstOrDefault(null,
function(a){return a.ToCaption()==b.properties.Name}),c=c?a.getValue(c):0;b.properties.value=c;return{weight:2,opacity:1,color:"white",dashArray:"1",fillOpacity:.7,fillColor:a.getGradientColor(c,f)}},onEachFeature:function(a,b){b.on({mouseover:g,mouseout:h})}}).addTo(a.map)};return function(b){return new c.prototype.constructor(b)}});
